---
title: After Many a Summer Dies the Swan
tags:
  - mixture model
  - phylobayes
  - dirichlet distribution
  - bayesian
categories:
  - diaries
date: 09-02-2023
---
# 0 After Many a Summer Dies the Swan
今年夏天在神农架、四川、贵州等地历时65天的采集已经结束了，现在是时候开始着手准备我10月份的开题了。经历了神农架、南京两次校际间交流，我更深刻地认识到了自己和其他人的差距。用图像来总结表征？听起来很理想，但是现实问题也是显然的——需要基因组来做参考，同时可以预见：表型信息本就冗杂，图像所能展现的表型信息又非常不完全，以此为基础做系统发育或其他分析是非常困难和不合适的。如果强行去做，做得好了，其实就是全基因组关联分析，然后对表型去拟合系统发育过程，再去做解释，如果做得不好，就会变成barcoding和表型关联的电子算命，成为笑柄。如果脱离基因组，那么工作的核心就变成了训练一个足够准确的图像识别模型，用一个博士课题去炼丹，大概只有江湖骗子才会这样做。

对深度学习的兴趣来自于我对新兴技术的沉迷，多了解新的技术总不是坏事，但是脱离了科学问题，所做的事情就会变得盲目，这样的盲目随着时间的发展注定会失败，陷入虚无。因而我重新审视了我要做的事情，并得到了一些新的思考和思路。我在此将这些思索的片段梳理，以便日后查阅。因为是当下的思考，当下的认识和学识都是非常有限的，日后看来很多内容都会是错误甚至可笑的，此文在于帮助以后的我了解本人博士开题之时所思考的问题，以便我整理自己思维的来龙去脉。如有人看到此文，发现错误或者可疑之处，希望您多加批评，多多讨论，我将感激不尽。

---
*注：After Many a Summer Dies the Swan 是赫胥黎的一部小说，讽刺美国文化肤浅地对年轻化的痴迷，主人公对永生肤浅的追求而忽略生活的本质会使其最终变成猿类，而如果我肤浅的追求“新颖”，而忽略科学问题，何尝不是一种对年轻化的痴迷，何尝不是对新生事物的盲目崇拜？盲目追求新技术而丢失思考，最终也会落得成为一个会用iphone的猿猴，一个不断灌水的机器。天鹅终会死去，新技术终会成熟转而变为旧技术。在这个夏天之后，我希望自己可以抛弃对新技术的盲目，与小说的主题组成双关，故借此为标题。*

---

# 1 我是谁，我要到哪里去
既然我要思考课题的方向，那么我应该先考虑清楚我是谁，我关心什么样的问题，这样我才能做到后续工作的逻辑自洽，而逻辑自洽是我认为决定工作、思考方向最重要的因素。诚如之前所思，到目前为止，我的思维方式是本质主义的，各种分子过程是我们对演化过程的描述介质，而非本质——观察数据来自演化结果，结果可以作为对过程的不完全观察，但是不能用以描述事件本身。如果把演化看作是连续的事件，那么基于结果的对事件的描述，无法准确区分误差和本质，只能通过大量数据进行统计推断；如果把演化看作现象的本质，相比推断现象的变化和相关性，我的“描述”行为更在乎其因果。对分子过程的细化可以提升演化推理的粒度，但是不会改变对演化过程的描述，即不会提供额外的信息，只是降低误差，或者说是进一步的模型拟合，是像素数更高的模糊图像。也就是说，观察数据蕴含规律，而我认为规律是根本，对数据的观察服务于对规律的描述（而非“规律是对数据的描述”）——某种层面上来讲，我应该也算是贝叶斯主义者，即描述在前。认清这一点，我才能知道我应该做什么样的研究。

对客观规律的描述本质上是一个抽象过程，在科学里，抽象往往使用数学方法。学科关注的是生命活动变化规律及其历史，那么对演化历史进行描述和建模，就是系统发育研究。系统发育推断，从数据的角度来讲，核心问题是系统发育信号的提取，系统发育信号，是由系统发育历史导致的观察数据分布特征，可认为是在一定先验知识（或称假设）下观察数据对系统发育中历史事件发生的估计。任何数据都有其演化历史，但是历史事件的空间是未知的，因此对历史的还原都是基于既定历史事件集合的，目前应用最广泛的历史事件是碱基突变。由于先验知识是与观察相独立的，而历史事件来自于先验知识，那么系统发育信号的提取大体上就可以分为观察和估计两个步骤。

应该注意的是，此处定义的历史事件实际上是对现生生物产生了可观测影响的历史事件，随着科学技术的发展，人类观测世界的能力不断发展，历史事件的含义也会不断拓展，在发现染色体前孟德尔就提出了遗传学的相关概念，这就是染色体行为产生了可观测的影响。反过来讲，未知历史事件产生的影响都被认为是数据的误差，或称为噪声。假设如果人类可以对历史的每一个细节都全知，那么我们可以推断出唯一的历史，即假设真随机不存在，也就是万物之间皆有因果。在此情况下，任何特征都是演化的结果，任何观测都是对历史事件的估计。然而在考虑有限个历史事件的情况下，如果未考虑的历史事件对观测值有影响，那么现实观测值对历史事件的估计存在必然的偏差。这种情况在现实世界中是普遍的，然而我们可以通过假设检验等方式，评估该偏差的相对大小，或已考虑情况发生的后验概率分布。比如细胞质中分子热运动对核苷酸的影响，属于一般不被考虑的历史事件，它们造成的影响在一般分析中就属于误差；基因水平转移、碱基丢失等事件，如果在分析中也不被考虑，那么其影响在该分析中也被认为是误差，如果其影响较大，那么该分析得到的结果就会产生偏差或矛盾。而对于已考虑历史事件的建模，应考虑其基本假设所规定的范围、观察值与模型参数的估计之间的测量误差的收敛性等因素。综上，可以得到这样的推理：任何观测都是对历史事件的独立估计，观测增加，历史事件也增加，在考虑固定历史事件的情况下，观测的增加不能带来更好的估计结果，所以当观测增加时应谨慎考虑其历史事件的描述是否适用。我希望我的后续工作会贯彻这样的观点，在内在逻辑上从一而终，做到逻辑自洽。

因而我的理想是这样的：我可以通过一些方法，在不断通过观测获得数据和规律的时候，不断逼近一个稳定的系统发育历史。数据和规律是随着时代发展不断更新、无穷无尽的，因而最关键的问题是对多源数据的兼容性和可扩展性，以及对真实范围的估计。那么我可以先从一个小的、具体的问题入手，首先我应该试着解决当前系统发育推断中，多源分子数据与形态数据之间整合的问题——显然这是一个尚且没有被很好解决的问题。现在思路整体清晰了，可以开始看看文献了。
# 2 看看文献

我实际上要查阅的是这样的：了解如今人们如何描述分子的系统发育，考虑了哪些可能的历史事件，目前还存在哪些缺陷；了解人们如何描述形态表型的演化，如何考虑其演化历史，是否能与分子特征相结合；目前结合分析的方法有哪些，能不能提供有效的推断。

那么在分子系统发育推断中，针对前期降噪来说，可以是拼接更高质量的全基因组序列，这显然不是我想要做的内容（某种程度上讲，不想做的主要原因是它是主流）。高质量的全基因组误差低，错误少；相比常规基因组，提供了更多位置信息，在系统发育推断时具备分析重组等过程的能力，是基因序列的更准确的观察。

但是可解释性可以提高系统发育分析的准确率或者分辨率吗？目前分析方法，也就是提供解释性的这种思路来说，好像不太行。换句话说，这本质上没有把表性特征结合到系统发育推断里，只是系统发育推断的一个后续罢了。一些证据就是，如果其他证据和全基因组证据出现矛盾，一般的做法仍是以基因组为标准去解释其他错误产生的原因。而如构建联合矩阵之流的做法，则是简单的加权，没有做到真正意义的结合，或者说没有降低系统误差，反而引入了更多的不确定性。而针对模型拟合的问题，从常用的方法来看，混合模型mixture model已经可以提供很好的分子系统发育结果，但是面对这样的模型，人们难免会提出一个“为什么”的问题——模型本身没有提供很好的解释性。而且目前的混合模型是否已经考虑了所有可能的变化，是否还可以进一步拓展呢？比如考虑昆虫漫长的演化历史，同一位点在不同时间范围内的演化速率也可能是不一样的：不同历史时期，环境不同，地理位置不同，种群发展情况不同，受到的选择压力不同，进化速率肯定也不同。

现在既然是要想课题，那么肯定要给目前的现状挑挑毛病。先想想都有什么是可以做的：如果要提高数据量，可以拼接质量更高的基因组，或者找其他数据来结合；如果想从模型角度下手，目前主要可用的模型都是基于分子的，也有一些基于生物地理的。我对更新更贵的测序没有兴趣，何况现在动不动读长上到M级，还需要我做什么呢。而分子数据演化模型也大都已经成熟，基因组水平的演化模型仍有一些可以改进的地方，但是总体来看，混合模型已经比较成功，限制基因组系统发育分析的主要因素还是基因组质量，修改模型带来的好处不如多测几倍illumina，最为关键的是我没有实际上的基因组数据，仅仅改个模型似乎并不足以让我毕业。对于拓展数据来源这一方向，目前受到一些关注，但是进展比较缓慢。大家都在说分子结合形态会带来更好的系统发育结果，但是目前的结合仍然是简单的堆砌，没有应用在推断过程中。如果要做到真正有机地结合二者，就要考虑二者之间所存在的内在联系，那么形态，或者说表型，与分子序列是否存在内在联系呢？当然存在，整个分子生物学都在研究这方面内容——基因序列和环境共同决定表型性状。表型信息能否因此而提供更多的系统发育信息呢？理论上讲，表型不同，功能不同，受到环境压力不同，对基因变化的约束就不同，基因演化速率就不同。

现在要做的是描述物种的演化历史，用从物种采样得到特征代表个体，用个体来估计物种种群的群体，并以此来进行演化的相关推断。个体作为独立系统有基因组和表型两套相互关联的部分，系统内节点存在相互作用，节点变化随时间连续随机进行，环境对表型产生选择，相同功能的非同源表型受到单个“环境因子”的影响相同。我要关注的核心问题是：整合表型和基因两套系统做系统发育推断。到此为止，整体思路算是比较清晰了，我该搜一下相关的文献了。

首先，整合形态特征和分子序列，一般的做法就是串联在一起，分子使用分子演化模型的，形态使用形态演化模型或者简约法，然后计算联合后验概率或者使用加权的方法。







问题：对于一个稳定的群体来说，基因频率不改变，那么子代和父代群体基因频率不变，不同的两种基因型在系统发育上关系如何？系统发育关系应该反应在这里吗，应该反应选择的变化还是代际变化？
答：连基因树和物种树都没分清楚还在这提问呢，滚回去看书！


# What I have done today

1. blah 
2. blah

# What I need to do next
- [ ] blah
- [ ]  blah

# What I want to do in future
- [ ]  ideas 
- [ ]  ideas

# What I want to tell myself

<div align=center>
<img src="/Pictures/*.jpeg" width="500" />
<br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">
      Add Title here
</div>
</div>